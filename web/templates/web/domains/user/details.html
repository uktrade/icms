{% extends "layout/sidebar.html" %}
{% import "forms/forms.html" as forms %}
{% import "forms/fields.html" as fields %}
{% import "forms/formsets.html" as formsets %}
{% block page_title %}Contact Details{% endblock %}
{% block context_header %}Contact Details{% endblock %}

{% block sidebar %}
<h4>My details</h4>
<ul class="menu-out">
    <li><a href="{{ icms_url('current-user-details') }}">Contact Details</a></li>
    {% if show_password_change %}
      <li><a href="{{ icms_url('accounts:password_change') }}">Change Password</a></li>
    {% endif %}
    {% if show_account_recovery %}
      <li><a href="{{ icms_url('account-recovery') }}">Account Recovery</a></li>
    {% endif %}
</ul>
{% endblock %}

{% block main_content %}

<h3>General Details</h3>

<div class="info-box info-box-info">
    These details will be used throughout the system and might be visible to other users. Please make sure they're accurate and up to date.
</div>

  {% call forms.form(method='post', csrf_input=csrf_input )-%}

    {% set edit_address %}
    <button name="action" value="edit_address" type="submit"
            class="link-button inline-link-button icon-pencil button no-prompt-action tooltipstered"
            aria-describedby="edit-address-hint" aria-label="Click here to edit Work Address">
    </button>
    <div id="edit-address-hint" role="tooltip" class="hint-content" >Edit work address</div>
    {% endset %}

    {{fields.field(details_form.title, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.first_name, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.last_name, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.date_of_birth, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.organisation, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.department, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.job_title, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.location_at_address, label_cols='four', input_cols='four')}}
    {{fields.field(details_form.work_address, tooltip=edit_address, label_cols='four', input_cols='four')}}

   <!-- Phone numbers -->
    {% with formset = phones_formset %}
    {% include 'partial/phone-numbers.html' %}
    {% endwith %}

    <!-- Email addresses -->
    {% with formset=emails_formset,
            title="Email Addresses",
            id="emails",
            form_item_class="person_email"
    %}
    {% include 'partial/email-addresses.html' %}
    {% endwith %}

    <div class="clearBoth"></div>
    <div class="container">
      <div class="row">
        <div class="four columns">
          <ul class="menu-out flow-across">
            <li>
              <button type="submit" name="action" value="save" class="primary-button button">
        Save
              </button>
            </li>
            <li>
              <a href="" class="button link-button"></a>
            </li>
          </ul>
        </div>
        <div class="four columns"></div>
      </div>
    </div>


{%- endcall %}

{% endblock %}
