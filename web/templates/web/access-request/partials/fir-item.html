{% import "forms/fields.html" as fields %}
{% import "forms/forms.html" as forms %}


<fieldset>
    <a name="{{ fir.instance.id }}"></a>
    <legend><strong>FIR {{ idx }} </strong></legend>

    {% set fir_status = fir.status.value()|lower %}
    {% set form_actions_config = fir.Meta.actions %}
    {% set container_class = "display" if fir.requested_datetime else "edit" %}

    {% call forms.form(method='post', action="#%s" % fir.instance.id, csrf_input=csrf_input, container_class=container_class) -%}
        {{ fields.hidden('id', fir.instance.id) }}
        {{ fields.hidden('status', fir.status.value() ) }}

        {% with config=form_actions_config, buttons_list=fir.actions_top, padding="", class="small-button" %}
            {% include "web/access-request/partials/fields/form-buttons-row.html" %}
        {% endwith %}

        <div class="row">
           {% include "web/access-request/partials/fields/fir-status.html" %}
        </div>

        {% if fir.requested_datetime %}
            {# only shown on display form, edit form does not contain this fields #}
            <div class="row">
                {{ fields.inline_field_with_label(fir.requested_datetime) }}
                {{ fields.inline_field_with_label(fir.requested_by) }}
            </div>
        {% endif %}

        {{ fields.field(fir.request_subject) }}
        {{ fields.field(fir.email_cc_address_list) }}
        {{ fields.field(fir.request_detail) }}

        <div class="row">
            {# @todo: revise this layout when implementing file upload #}
            <div class="three columns">
                <label for="id_status" class="prompt west">Documents</label>
            </div>
            <div class="six columns">
                {% for file in fir.files %}
                    {{ fields.field(file) }}
                {% endfor %}
            </div>
        </div>

        {% with config=form_actions_config, buttons_list=fir.actions_bottom %}
            {% include "web/access-request/partials/fields/form-buttons-row.html" %}
        {% endwith %}

    {% endcall %}
</fieldset>
